# Define your constants here
sample_import_file_json = {"item_type": "workbook", "file_name": "workbook_templates_export - 11 workbooks exported - 2024-03-22", "date_time_exported": "2024-03-22 18:51:09.265695", "export_environment_base_URL": "https://127.0.0.1/", "export_environment_Splunk_SOAR_product_id": "f87da0efe5f3fca12171e53f47ae188db5a6d9d6b26bcfb2045a7fca0638df4a", "app_version": "1.0.1", "data": [{"name": "NIST 800-61", "is_default": true, "description": null, "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 5, "num_pages": 1, "data": [{"id": 1, "name": "Detection", "order": 1, "create_time": "2020-06-30T13:21:35.640895Z", "modified_time": "2020-06-30T13:21:35.641070Z", "template": 1, "sla": null, "sla_type": "minutes", "tasks": [{"id": 1, "name": "Determine if an incident has occurred", "order": 1, "owner": null, "role": null, "phase": 1, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.642550Z", "modified_time": "2020-06-30T13:21:35.642777Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 2, "name": "Analyze precursors and indicators", "order": 2, "owner": null, "role": null, "phase": 1, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.643177Z", "modified_time": "2020-06-30T13:21:35.643325Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 3, "name": "Look for correlating information", "order": 3, "owner": null, "role": null, "phase": 1, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.643588Z", "modified_time": "2020-06-30T13:21:35.643744Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 4, "name": "Perform research", "order": 4, "owner": null, "role": null, "phase": 1, "description": "Use search engines, knowledge bases etc.", "suggestions": {}, "create_time": "2020-06-30T13:21:35.643981Z", "modified_time": "2020-06-30T13:21:35.644123Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 5, "name": "Confirmed incident", "order": 5, "owner": null, "role": null, "phase": 1, "description": "Confirmed incident - document the investigation and gather evidence. Attach all relevant information from detection steps to the case", "suggestions": {}, "create_time": "2020-06-30T13:21:35.644346Z", "modified_time": "2020-06-30T13:21:35.644486Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 2, "name": "Analysis and Containment", "order": 2, "create_time": "2020-06-30T13:21:35.644710Z", "modified_time": "2020-06-30T13:21:35.644817Z", "template": 1, "sla": null, "sla_type": "minutes", "tasks": [{"id": 6, "name": "Determine functional impact", "order": 1, "owner": null, "role": null, "phase": 2, "description": "Suggested categories: None, Low, Medium, High", "suggestions": {}, "create_time": "2020-06-30T13:21:35.645707Z", "modified_time": "2020-06-30T13:21:35.645876Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 7, "name": "Determine information impact", "order": 2, "owner": null, "role": null, "phase": 2, "description": "Suggested Categories: None, Privacy breach, Proprietary breach, Integrity loss", "suggestions": {}, "create_time": "2020-06-30T13:21:35.646125Z", "modified_time": "2020-06-30T13:21:35.646270Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 8, "name": "Determine recoverability effort", "order": 3, "owner": null, "role": null, "phase": 2, "description": "Suggested categories: Regular, Supplemented, Extended, Not Recoverable", "suggestions": {}, "create_time": "2020-06-30T13:21:35.646499Z", "modified_time": "2020-06-30T13:21:35.646642Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 9, "name": "Prioritize incident", "order": 4, "owner": null, "role": null, "phase": 2, "description": "Prioritize handling the incident based on the relevant factors", "suggestions": {}, "create_time": "2020-06-30T13:21:35.646877Z", "modified_time": "2020-06-30T13:21:35.647019Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 10, "name": "Report incident", "order": 5, "owner": null, "role": null, "phase": 2, "description": "Report the incident to the the appropriate internal personnel and external organizations", "suggestions": {}, "create_time": "2020-06-30T13:21:35.647240Z", "modified_time": "2020-06-30T13:21:35.647380Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 11, "name": "Contain incident", "order": 6, "owner": null, "role": null, "phase": 2, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.647598Z", "modified_time": "2020-06-30T13:21:35.647748Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 3, "name": "Eradicate", "order": 3, "create_time": "2020-06-30T13:21:35.647970Z", "modified_time": "2020-06-30T13:21:35.648076Z", "template": 1, "sla": null, "sla_type": "minutes", "tasks": [{"id": 12, "name": "Identify and mitigate all vulnerabilities", "order": 1, "owner": null, "role": null, "phase": 3, "description": "Identify and mitigate all vulnerabilities that were exploited", "suggestions": {}, "create_time": "2020-06-30T13:21:35.648949Z", "modified_time": "2020-06-30T13:21:35.649115Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 13, "name": "Removal of malicious content", "order": 2, "owner": null, "role": null, "phase": 3, "description": "Removed malware, inappropriate materials and other components", "suggestions": {}, "create_time": "2020-06-30T13:21:35.649355Z", "modified_time": "2020-06-30T13:21:35.649499Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 14, "name": "Verify no other hosts are affected", "order": 3, "owner": null, "role": null, "phase": 3, "description": "If more affected hosts are discovered, repeat the Detection and Analysis Steps", "suggestions": {}, "create_time": "2020-06-30T13:21:35.649735Z", "modified_time": "2020-06-30T13:21:35.649875Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 4, "name": "Recovery", "order": 4, "create_time": "2020-06-30T13:21:35.650096Z", "modified_time": "2020-06-30T13:21:35.650200Z", "template": 1, "sla": null, "sla_type": "minutes", "tasks": [{"id": 15, "name": "Restore affected systems", "order": 1, "owner": null, "role": null, "phase": 4, "description": "Return affected systems to an operationally ready state", "suggestions": {}, "create_time": "2020-06-30T13:21:35.651076Z", "modified_time": "2020-06-30T13:21:35.651241Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 16, "name": "Validate restoration", "order": 2, "owner": null, "role": null, "phase": 4, "description": "Confirm that the affected systems are functioning normally", "suggestions": {}, "create_time": "2020-06-30T13:21:35.651583Z", "modified_time": "2020-06-30T13:21:35.651756Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 17, "name": "Implement additional monitoring", "order": 3, "owner": null, "role": null, "phase": 4, "description": "If necessary, implement additional monitoring to look for future activity", "suggestions": {}, "create_time": "2020-06-30T13:21:35.652016Z", "modified_time": "2020-06-30T13:21:35.652160Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 5, "name": "Post Incident Activity", "order": 5, "create_time": "2020-06-30T13:21:35.652382Z", "modified_time": "2020-06-30T13:21:35.652488Z", "template": 1, "sla": null, "sla_type": "minutes", "tasks": [{"id": 18, "name": "Create a follow up report", "order": 1, "owner": null, "role": null, "phase": 5, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.653364Z", "modified_time": "2020-06-30T13:21:35.653542Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 19, "name": "Lessons learned", "order": 2, "owner": null, "role": null, "phase": 5, "description": "Hold a lesson learned meeting (mandatory for major incidents, optional otherwise)", "suggestions": {}, "create_time": "2020-06-30T13:21:35.653800Z", "modified_time": "2020-06-30T13:21:35.653944Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Response Template 1", "is_default": false, "description": null, "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 6, "num_pages": 1, "data": [{"id": 6, "name": "Detection", "order": 1, "create_time": "2020-06-30T13:21:35.658001Z", "modified_time": "2020-06-30T13:21:35.658122Z", "template": 2, "sla": null, "sla_type": "minutes", "tasks": [{"id": 20, "name": "Report incident response execution", "order": 1, "owner": null, "role": null, "phase": 6, "description": "Alert appropriate parties to incident response execution starting", "suggestions": {}, "create_time": "2020-06-30T13:21:35.659199Z", "modified_time": "2020-06-30T13:21:35.659387Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 21, "name": "Document associated events", "order": 2, "owner": null, "role": null, "phase": 6, "description": "This is the escalation. Create case and populate it with significant container data", "suggestions": {}, "create_time": "2020-06-30T13:21:35.659654Z", "modified_time": "2020-06-30T13:21:35.659815Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 22, "name": "Document known attack surface and attacker information", "order": 3, "owner": null, "role": null, "phase": 6, "description": "Rough triage of the situation. No complete picture but targets to analyse", "suggestions": {}, "create_time": "2020-06-30T13:21:35.660053Z", "modified_time": "2020-06-30T13:21:35.660197Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 23, "name": "Assign roles", "order": 4, "owner": null, "role": null, "phase": 6, "description": "Incident commander, Tech lead, Scribe, Intel analysts, Security analysts", "suggestions": {}, "create_time": "2020-06-30T13:21:35.660423Z", "modified_time": "2020-06-30T13:21:35.660567Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 7, "name": "Analysis", "order": 2, "create_time": "2020-06-30T13:21:35.660796Z", "modified_time": "2020-06-30T13:21:35.660905Z", "template": 2, "sla": null, "sla_type": "minutes", "tasks": [{"id": 24, "name": "Research intelligence resources", "order": 1, "owner": null, "role": null, "phase": 7, "description": "Find out if this attacker is a known agent and gather associated TTP", "suggestions": {}, "create_time": "2020-06-30T13:21:35.661780Z", "modified_time": "2020-06-30T13:21:35.661947Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 25, "name": "Research proxy logs", "order": 2, "owner": null, "role": null, "phase": 7, "description": "Find and document any evidence linked to attacker actions", "suggestions": {}, "create_time": "2020-06-30T13:21:35.662195Z", "modified_time": "2020-06-30T13:21:35.662340Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 26, "name": "Research firewall logs", "order": 3, "owner": null, "role": null, "phase": 7, "description": "Find and document any evidence linked to attacker actions", "suggestions": {}, "create_time": "2020-06-30T13:21:35.662566Z", "modified_time": "2020-06-30T13:21:35.662717Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 27, "name": "Research OS logs", "order": 4, "owner": null, "role": null, "phase": 7, "description": "Find and document any evidence linked to attacker actions", "suggestions": {}, "create_time": "2020-06-30T13:21:35.662942Z", "modified_time": "2020-06-30T13:21:35.663084Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 28, "name": "Research network logs", "order": 5, "owner": null, "role": null, "phase": 7, "description": "Find and document any evidence linked to attacker actions", "suggestions": {}, "create_time": "2020-06-30T13:21:35.663304Z", "modified_time": "2020-06-30T13:21:35.663441Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 29, "name": "Research endpoint protection logs", "order": 6, "owner": null, "role": null, "phase": 7, "description": "Find and document any evidence linked to attacker actions", "suggestions": {}, "create_time": "2020-06-30T13:21:35.663687Z", "modified_time": "2020-06-30T13:21:35.663830Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 30, "name": "Determine infection vector", "order": 7, "owner": null, "role": null, "phase": 7, "description": "Find and document how initial infection occurred", "suggestions": {}, "create_time": "2020-06-30T13:21:35.664057Z", "modified_time": "2020-06-30T13:21:35.664198Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 31, "name": "Document all attack targets", "order": 8, "owner": null, "role": null, "phase": 7, "description": "Find and document full attack surface", "suggestions": {}, "create_time": "2020-06-30T13:21:35.664420Z", "modified_time": "2020-06-30T13:21:35.664559Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 32, "name": "Document all attacker sources and TTP", "order": 9, "owner": null, "role": null, "phase": 7, "description": "Document all discovered attack source and TTP", "suggestions": {}, "create_time": "2020-06-30T13:21:35.664789Z", "modified_time": "2020-06-30T13:21:35.664930Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 33, "name": "Document infected devices", "order": 10, "owner": null, "role": null, "phase": 7, "description": "Document all devices known determined to have been modified by attacker", "suggestions": {}, "create_time": "2020-06-30T13:21:35.665153Z", "modified_time": "2020-06-30T13:21:35.665293Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 34, "name": "Determine full impact of attack", "order": 11, "owner": null, "role": null, "phase": 7, "description": "Functional and informational impact", "suggestions": {}, "create_time": "2020-06-30T13:21:35.665516Z", "modified_time": "2020-06-30T13:21:35.665656Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 35, "name": "Analyse malware samples", "order": 12, "owner": null, "role": null, "phase": 7, "description": "Analyse discovered malware and document IOCs", "suggestions": {}, "create_time": "2020-06-30T13:21:35.665893Z", "modified_time": "2020-06-30T13:21:35.666034Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 8, "name": "Containment", "order": 3, "create_time": "2020-06-30T13:21:35.666247Z", "modified_time": "2020-06-30T13:21:35.666352Z", "template": 2, "sla": null, "sla_type": "minutes", "tasks": [{"id": 36, "name": "Acquire, preserve, secure and document evidence", "order": 1, "owner": null, "role": null, "phase": 8, "description": "Before modifying systems housing evidence of attack, document it", "suggestions": {}, "create_time": "2020-06-30T13:21:35.667238Z", "modified_time": "2020-06-30T13:21:35.667405Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 37, "name": "Report devices and applications to be contained to proper channels", "order": 2, "owner": null, "role": null, "phase": 8, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.667649Z", "modified_time": "2020-06-30T13:21:35.667806Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 38, "name": "Contain incident", "order": 3, "owner": null, "role": null, "phase": 8, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.668041Z", "modified_time": "2020-06-30T13:21:35.668182Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 9, "name": "Eradication", "order": 4, "create_time": "2020-06-30T13:21:35.668403Z", "modified_time": "2020-06-30T13:21:35.668508Z", "template": 2, "sla": null, "sla_type": "minutes", "tasks": [{"id": 39, "name": "Identify and mitigate all vulnerabilities that were exploited", "order": 1, "owner": null, "role": null, "phase": 9, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.669388Z", "modified_time": "2020-06-30T13:21:35.669554Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 40, "name": "Remove malware, inappropriate materials and other components", "order": 2, "owner": null, "role": null, "phase": 9, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.669817Z", "modified_time": "2020-06-30T13:21:35.669965Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 41, "name": "Repeat analysis and containment on any newly discovered infected hosts", "order": 3, "owner": null, "role": null, "phase": 9, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.670198Z", "modified_time": "2020-06-30T13:21:35.670341Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 10, "name": "Recovery", "order": 5, "create_time": "2020-06-30T13:21:35.670562Z", "modified_time": "2020-06-30T13:21:35.670680Z", "template": 2, "sla": null, "sla_type": "minutes", "tasks": [{"id": 42, "name": "Return affected systems to an operationally ready state", "order": 1, "owner": null, "role": null, "phase": 10, "description": "Restore network connectivity and system access", "suggestions": {}, "create_time": "2020-06-30T13:21:35.671554Z", "modified_time": "2020-06-30T13:21:35.671732Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 43, "name": "Confirm that the affected systems are functioning normally", "order": 2, "owner": null, "role": null, "phase": 10, "description": "Work with system owners to validate successful recovery", "suggestions": {}, "create_time": "2020-06-30T13:21:35.671981Z", "modified_time": "2020-06-30T13:21:35.672124Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 44, "name": "If necessary, implement additional monitoring to look for future related activity", "order": 3, "owner": null, "role": null, "phase": 10, "description": "Be ready to identify a similar attack with proper monitoring", "suggestions": {}, "create_time": "2020-06-30T13:21:35.672356Z", "modified_time": "2020-06-30T13:21:35.672495Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 11, "name": "Post", "order": 6, "create_time": "2020-06-30T13:21:35.672718Z", "modified_time": "2020-06-30T13:21:35.672824Z", "template": 2, "sla": null, "sla_type": "minutes", "tasks": [{"id": 45, "name": "Schedule after action review meeting", "order": 1, "owner": null, "role": null, "phase": 11, "description": "", "suggestions": {}, "create_time": "2020-06-30T13:21:35.673724Z", "modified_time": "2020-06-30T13:21:35.673895Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 46, "name": "Generate incident response action report", "order": 2, "owner": null, "role": null, "phase": 11, "description": "Both executive report and detailed final report", "suggestions": {}, "create_time": "2020-06-30T13:21:35.674149Z", "modified_time": "2020-06-30T13:21:35.674298Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 47, "name": "Report incident response execution complete", "order": 3, "owner": null, "role": null, "phase": 11, "description": "Alert appropriate parties to incident response execution complete", "suggestions": {}, "create_time": "2020-06-30T13:21:35.674531Z", "modified_time": "2020-06-30T13:21:35.674684Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Account Compromise", "is_default": false, "description": "This case template defines a response to the potential compromise of one or more system or application accounts. Across the enterprise, user and service accounts are high-value targets that provide access to wide varieties of resources and capabilities. If an unauthorized entity gains access to an account in your organization, these phases and tasks can be used to organize the effort to investigate and respond. No two account compromises are the same, so some portions of this case template might not apply to certain types of account takeovers, and in most cases there will be additional appropriate responses going beyond those listed below. The general structure of this case template is based on NIST SP 800-61 Revision 2 and some of the techniques come from the Credential Access tactic in the MITRE ATT&CK framework (https://attack.mitre.org/tactics/TA0006/).", "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 3, "num_pages": 1, "data": [{"id": 12, "name": "Detection and Analysis", "order": 1, "create_time": "2020-06-30T13:21:35.678646Z", "modified_time": "2020-06-30T13:21:35.678780Z", "template": 3, "sla": null, "sla_type": "minutes", "tasks": [{"id": 48, "name": "Contact account owner", "order": 1, "owner": null, "role": null, "phase": 12, "description": "If situational awareness concerns allow it, contact the legitimate owner of the account to gather additional insight, rule out false positives, and provide guidance on how to cooperate.", "suggestions": {"actions": ["get user", "send email", "send message", "ask question"]}, "create_time": "2020-06-30T13:21:35.679679Z", "modified_time": "2020-06-30T13:21:35.679853Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 49, "name": "Determine the scope of the compromise", "order": 2, "owner": null, "role": null, "phase": 12, "description": "Determine the resources and capabilities available to the compromised account. Consider other types of accounts that can also be accessed based on the initial compromise. Is this account an Administrative account? What systems has the account logged into?", "suggestions": {"actions": ["run query", "get user info", "get user attributes", "list sessions"]}, "create_time": "2020-06-30T13:21:35.680266Z", "modified_time": "2020-06-30T13:21:35.680412Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 50, "name": "Analyze usage of access", "order": 3, "owner": null, "role": null, "phase": 12, "description": "Query monitoring systems to determine which of the potential resources and capabilities were actually used by the adversary. Look for patterns in targeted resources and capabilities. Was the compromised account used to install or download something? Were credentials to other accounts collected and used?", "suggestions": {"actions": ["run query", "list processes", "list connections", "get command history"], "playbooks": [{"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.680678Z", "modified_time": "2020-06-30T13:21:35.680825Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 51, "name": "Estimate impact", "order": 4, "owner": null, "role": null, "phase": 12, "description": "Estimate the business impact to appropriately allocate priority and resources.", "suggestions": {"actions": ["run query", "hunt hash", "hunt malware"]}, "create_time": "2020-06-30T13:21:35.681079Z", "modified_time": "2020-06-30T13:21:35.681224Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 52, "name": "Track stolen credentials", "order": 5, "owner": null, "role": null, "phase": 12, "description": "If compromised credentials were used, try to determine where else they may grant access.", "suggestions": {"actions": ["run query"], "playbooks": [{"scm": "community", "playbook": "excessive_account_lockouts_enrichment_and_response"}]}, "create_time": "2020-06-30T13:21:35.681455Z", "modified_time": "2020-06-30T13:21:35.681598Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 53, "name": "Investigate external communications", "order": 6, "owner": null, "role": null, "phase": 12, "description": "Look for exfiltration and/or command and control activity. Inspect network traffic with abnormal content, focusing on traffic to external hosts and internal systems that are not normally connected to the system under investigation.", "suggestions": {"actions": ["run query", "list connections", "hunt domain"], "playbooks": [{"scm": "community", "playbook": "simple_network_enrichment"}, {"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.681850Z", "modified_time": "2020-06-30T13:21:35.681995Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 54, "name": "Determine initial access mechanism", "order": 7, "owner": null, "role": null, "phase": 12, "description": "Attempt to trace activity back to the point of initial access. Consider phishing, watering hole attacks, public-facing exploits, supply chain compromises, and other common attack mechanisms.", "suggestions": {"actions": ["run query"]}, "create_time": "2020-06-30T13:21:35.682235Z", "modified_time": "2020-06-30T13:21:35.682379Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 55, "name": "Detect persistent system access", "order": 8, "owner": null, "role": null, "phase": 12, "description": "Look for attempts to establish persistent access to one or more systems. The persistence technique could include an email forwarding rule for an email account, a scheduled task on an endpoint, a newly added login method for a business application, or a wide array of others. One non-exhaustive list of persistence techniques is in the MITRE ATT&CK framework (https://attack.mitre.org/tactics/TA0003/) and another for Windows endpoints in particular is within the SysInternals Autoruns tool.", "suggestions": {"actions": ["run query", "run script", "list packages", "get command history"]}, "create_time": "2020-06-30T13:21:35.682609Z", "modified_time": "2020-06-30T13:21:35.682763Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 56, "name": "Enumerate other similarly vulnerable accounts", "order": 9, "owner": null, "role": null, "phase": 12, "description": "If an initial attack vector or other activity pattern is found, use it to look for other similarly compromised accounts.", "suggestions": {"actions": ["run query", "list endpoints"]}, "create_time": "2020-06-30T13:21:35.683001Z", "modified_time": "2020-06-30T13:21:35.683145Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 57, "name": "Notify stakeholders", "order": 10, "owner": null, "role": null, "phase": 12, "description": "Notify incident response leadership, system owners, and other stakeholders in accordance with established incident notification and escalation procedures.", "suggestions": {"actions": ["send email", "send message", "get oncall user", "create ticket"], "playbooks": [{"scm": "community", "playbook": "email_notification_for_malware"}]}, "create_time": "2020-06-30T13:21:35.683374Z", "modified_time": "2020-06-30T13:21:35.683529Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 13, "name": "Containment, Eradication, and Recovery", "order": 2, "create_time": "2020-06-30T13:21:35.683779Z", "modified_time": "2020-06-30T13:21:35.683887Z", "template": 3, "sla": null, "sla_type": "minutes", "tasks": [{"id": 58, "name": "Disable account", "order": 1, "owner": null, "role": null, "phase": 13, "description": "If the business risk is deemed acceptable, disable the account or reset credentials to prevent further malicious usage.", "suggestions": {"actions": ["reset password", "disable user", "add firewall rule", "shutdown system"], "playbooks": [{"scm": "community", "playbook": "compromised_email_containment"}, {"scm": "community", "playbook": "excessive_account_lockouts_enrichment_and_response"}, {"scm": "community", "playbook": "macos_root_password_mitigate"}]}, "create_time": "2020-06-30T13:21:35.684816Z", "modified_time": "2020-06-30T13:21:35.684986Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 59, "name": "Remove persistent system access", "order": 2, "owner": null, "role": null, "phase": 13, "description": "If persistent access mechanisms were detected, remove them by uninstalling software, unhooking libraries, reimaging systems, disabling compromised credentials, or implementing other remediations. If this action will cause a service outage, it may be prudent to notify the affected teams or organizations.", "suggestions": {"actions": ["block hash", "run command", "run script", "restart system", "block file path", "block application", "revert vm"]}, "create_time": "2020-06-30T13:21:35.685261Z", "modified_time": "2020-06-30T13:21:35.685411Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 60, "name": "Mitigate or remediate vulnerabilities", "order": 3, "owner": null, "role": null, "phase": 13, "description": "If any vulnerabilities were used in this compromise, find a way to mitigate or remediate them. This could be a system update, a change in software, disabling a certain feature, a change in policy, or another action.", "suggestions": {"actions": ["deploy patch", "run script", "update device"]}, "create_time": "2020-06-30T13:21:35.685653Z", "modified_time": "2020-06-30T13:21:35.685809Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 14, "name": "Post-incident Activity", "order": 3, "create_time": "2020-06-30T13:21:35.686040Z", "modified_time": "2020-06-30T13:21:35.686147Z", "template": 3, "sla": null, "sla_type": "minutes", "tasks": [{"id": 61, "name": "Notify necessary parties", "order": 1, "owner": null, "role": null, "phase": 14, "description": "Determine if a regulatory risk calls for a notification to an internal or external compliance organization. Also consider an informational notice to users to prevent similar compromises through improved security hygiene.", "suggestions": {"actions": ["send email", "send message"]}, "create_time": "2020-06-30T13:21:35.687046Z", "modified_time": "2020-06-30T13:21:35.687215Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 62, "name": "Tune prevention systems", "order": 2, "owner": null, "role": null, "phase": 14, "description": "Depending on the mechanism of access and the systems affected, there may be a clear next step to prevent similar compromises. This may involve deployment of strong multi-factor authentication, improved automated response, stronger application of least privilege, user training, and/or a wide array of other defensive measures. Consider using CIS Cybersecurity Best Practices (https://www.cisecurity.org/cybersecurity-best-practices/) or a similar framework to assess improvements in prevention.", "suggestions": {"actions": ["scan network", "deploy patch", "create ticket"], "playbooks": []}, "create_time": "2020-06-30T13:21:35.687470Z", "modified_time": "2020-06-30T13:21:35.687616Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 63, "name": "Tune detection systems", "order": 3, "owner": null, "role": null, "phase": 14, "description": "Any of the steps taken within the Detection and Analysis phase may be candidates for automated or regularly scheduled detections to find similar activity. Focus on the most generalizable patterns that will catch high-impact compromises as early as possible.", "suggestions": {"actions": ["run query"], "playbooks": [{"scm": "community", "playbook": "track_active_directory_admin_users"}]}, "create_time": "2020-06-30T13:21:35.687877Z", "modified_time": "2020-06-30T13:21:35.688023Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Data Breach", "is_default": false, "description": null, "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 6, "num_pages": 1, "data": [{"id": 15, "name": "Escalate to accountable system owners", "order": 1, "create_time": "2020-06-30T13:21:35.692023Z", "modified_time": "2020-06-30T13:21:35.692149Z", "template": 4, "sla": null, "sla_type": "minutes", "tasks": [{"id": 64, "name": "Identify accountable system owners", "order": 1, "owner": null, "role": null, "phase": 15, "description": "Query configuration management databases, ask teammates, and query on-call personnel directories to find the right people for notification and response.", "suggestions": {"actions": ["run query", "list oncalls", "get oncall", "get system attributes", "get user attributes", "get users", "ask question"], "playbooks": [{"scm": "community", "playbook": "track_active_directory_admin_users"}]}, "create_time": "2020-06-30T13:21:35.693072Z", "modified_time": "2020-06-30T13:21:35.693244Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 65, "name": "Notify accountable system owners", "order": 2, "owner": null, "role": null, "phase": 15, "description": "Determine what is needed from each team member and notify them as soon as possible. Consider speed, confidentiality, integrity, and availability when choosing a communication channel. The right choice may be an in-person meeting, email, chat, text, phone call, or Phantom Notification.", "suggestions": {"actions": ["send email", "send message", "create task"], "playbooks": [{"scm": "community", "playbook": "email_notification_for_malware"}]}, "create_time": "2020-06-30T13:21:35.693536Z", "modified_time": "2020-06-30T13:21:35.693696Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 66, "name": "Setup collaboration channels", "order": 3, "owner": null, "role": null, "phase": 15, "description": "Establish shared access to the appropriate Phantom Mission Control that is tracking the data breach. If necessary establish an additional channel for communications such as a chat room, email chain, ticketing system, or VictorOps Incident.", "suggestions": {"actions": ["create event", "create investigation", "create alert", "create ticket"], "playbooks": [{"scm": "community", "playbook": "user_approved_ticket_creation"}]}, "create_time": "2020-06-30T13:21:35.693982Z", "modified_time": "2020-06-30T13:21:35.694127Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 16, "name": "Stop exfiltration", "order": 2, "create_time": "2020-06-30T13:21:35.694368Z", "modified_time": "2020-06-30T13:21:35.694473Z", "template": 4, "sla": null, "sla_type": "minutes", "tasks": [{"id": 67, "name": "Identify likely means of exfiltration", "order": 1, "owner": null, "role": null, "phase": 16, "description": "Evaluate likely means of exfiltration using the information from the initial detection and any other associated investigation the team can conduct. Use https://attack.mitre.org/wiki/Persistence and other open source intelligence to check for common exfiltration mechanisms. Consider the sophistication of the adversary, the data that is likely to be targeted, the systems that may have been breached, and any other knowledge from further investigation. Query the logs of any available systems around the time of the incident for context and additional leads. If possible analyze and/or reverse engineer any executables or scripts discovered in the investigation. Try to determine exfiltration mechanisms, protocols, ports, IP addresses, hostnames, URL's, and other indicators.", "suggestions": {"actions": ["run query", "run command", "detonate file", "detonate url", "file reputation", "get file", "get file info"], "playbooks": [{"scm": "community", "playbook": "symantec_ioc_data_enhancement"}, {"scm": "community", "playbook": "email_notification_for_malware"}, {"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.695371Z", "modified_time": "2020-06-30T13:21:35.695542Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 68, "name": "Determine mitigations and remediations", "order": 2, "owner": null, "role": null, "phase": 16, "description": "Taking into account the confidentiality and availability considerations of the systems involved, determine which mitigations and remediations are appropriate.", "suggestions": {"actions": ["run query", "get data"], "playbooks": [{"scm": "community", "playbook": "alert_escalation_for_attacked_executives"}, {"scm": "community", "playbook": "alert_deescalation_for_test_machines"}]}, "create_time": "2020-06-30T13:21:35.695832Z", "modified_time": "2020-06-30T13:21:35.695981Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 69, "name": "Stop exfiltration", "order": 3, "owner": null, "role": null, "phase": 16, "description": "Use host-based or network controls to interrupt exfiltration. Scope the response according to the severity of the event.", "suggestions": {"actions": ["block domain", "block ip", "block url", "block application", "quarantine device", "shutdown system", "delete file", "block hash"], "playbooks": [{"scm": "community", "playbook": "user_prompt_and_block_domain"}]}, "create_time": "2020-06-30T13:21:35.696228Z", "modified_time": "2020-06-30T13:21:35.696370Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 17, "name": "Remove persistent adversaries", "order": 3, "create_time": "2020-06-30T13:21:35.696609Z", "modified_time": "2020-06-30T13:21:35.696727Z", "template": 4, "sla": null, "sla_type": "minutes", "tasks": [{"id": 70, "name": "Identify likely means of persistence", "order": 1, "owner": null, "role": null, "phase": 17, "description": "Trace exfiltration as far as possible back toward a root cause. Look for patterns of activity from scheduled tasks, system restarts, polling of external systems, and other common means of persistence. Sysinternals AutoRuns and other similar tools can check wide varieties of persistence mechanisms.", "suggestions": {"actions": ["run query", "execute program", "detonate file"], "playbooks": [{"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.697615Z", "modified_time": "2020-06-30T13:21:35.697798Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 71, "name": "Remove identified persistence mechanisms", "order": 2, "owner": null, "role": null, "phase": 17, "description": "Block adversary persistence at the host and/or network level.", "suggestions": {"actions": ["block file path", "block hash", "block ip", "block domain"], "playbooks": [{"scm": "community", "playbook": "user_prompt_and_block_domain"}]}, "create_time": "2020-06-30T13:21:35.698064Z", "modified_time": "2020-06-30T13:21:35.698210Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 18, "name": "Assess impact", "order": 4, "create_time": "2020-06-30T13:21:35.698447Z", "modified_time": "2020-06-30T13:21:35.698553Z", "template": 4, "sla": null, "sla_type": "minutes", "tasks": [{"id": 72, "name": "Measure the size and scope", "order": 1, "owner": null, "role": null, "phase": 18, "description": "Measure the impact of the breach by amount of data, importance of data, potential follow-on impacts, and other appropriate criteria.", "suggestions": {"actions": ["run query", "get data"]}, "create_time": "2020-06-30T13:21:35.699447Z", "modified_time": "2020-06-30T13:21:35.699616Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 19, "name": "Report to appropriate stakeholders", "order": 5, "create_time": "2020-06-30T13:21:35.699880Z", "modified_time": "2020-06-30T13:21:35.699991Z", "template": 4, "sla": null, "sla_type": "minutes", "tasks": [{"id": 73, "name": "Identify appropriate stakeholders", "order": 1, "owner": null, "role": null, "phase": 19, "description": "Identify who should receive which information. This may include the regulatory compliance team, all internal employees, customers, partners, appropriate government officials, the public, system vendors, open source communities, and others.", "suggestions": {}, "create_time": "2020-06-30T13:21:35.700882Z", "modified_time": "2020-06-30T13:21:35.701051Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 74, "name": "Send reports", "order": 2, "owner": null, "role": null, "phase": 19, "description": "Send the appropriate amount of information to identified parties. If it would be beneficial give them a way to respond.", "suggestions": {"actions": ["send email", "submit report"]}, "create_time": "2020-06-30T13:21:35.701310Z", "modified_time": "2020-06-30T13:21:35.701458Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 20, "name": "Prevent future breaches", "order": 6, "create_time": "2020-06-30T13:21:35.701703Z", "modified_time": "2020-06-30T13:21:35.701813Z", "template": 4, "sla": null, "sla_type": "minutes", "tasks": [{"id": 75, "name": "Prevent future breaches", "order": 1, "owner": null, "role": null, "phase": 20, "description": "Use information from this case to investigate further, apply patches, prevent behaviors, change systems, and otherwise prevent similar situations from occurring again. Setup automated checks for reinfection using similar indicators or TTP's.", "suggestions": {"actions": ["deploy patch", "block hash", "block application"], "playbooks": [{"scm": "community", "playbook": "reinfected_endpoint_check"}]}, "create_time": "2020-06-30T13:21:35.702702Z", "modified_time": "2020-06-30T13:21:35.702873Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Network Indicator Enrichment", "is_default": false, "description": "Gather and analyze contextual information about URLs, hostnames, top level domain names, IP addresses, TLS certificates, and MAC addresses. These network indicators can be involved in security investigations of all types, so this workbook is meant to be added as a modular component into an event or case that may have other more specific phases and tasks. For instance, when investigating an account compromise, this workbook may be used during the investigation phase to rule out false positives and inform decisions about further investigation and response.", "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 1, "num_pages": 1, "data": [{"id": 21, "name": "Network Indicator Enrichment", "order": 1, "create_time": "2020-06-30T13:21:35.706851Z", "modified_time": "2020-06-30T13:21:35.706980Z", "template": 5, "sla": null, "sla_type": "minutes", "tasks": [{"id": 76, "name": "Enrich URLs", "order": 1, "owner": null, "role": null, "phase": 21, "description": "Gather reputation and behavioral information about a suspicious URL. Automated actions may include querying threat intelligence databases, dynamic profiling of the URL and the associated redirects, or checking the categorization of a URL in a proxy or other safe browsing tool. Manual actions may include checking for typosquatting/brandjacking, evaluating the appropriateness of the URL given the context in which it was detected, or manually investigating the site from a sandboxed environment. Additionally it might be appropriate to simply ask the user if they can explain why the URL was accessed. Outputs from this task could be used to pivot to investigation of underlying or associated domain names, other URLs, TLS certificates, IP addresses, or specific behaviors associated with the website such as Javascript execution patterns or downloaded files.", "suggestions": {"actions": ["url reputation", "detonate url", "lookup url", "run query", "ask question"], "playbooks": [{"scm": "community", "playbook": "simple_network_enrichment"}, {"scm": "community", "playbook": "symantec_proxysg_unblock_request"}]}, "create_time": "2020-06-30T13:21:35.707923Z", "modified_time": "2020-06-30T13:21:35.708101Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 77, "name": "Enrich domain names", "order": 2, "owner": null, "role": null, "phase": 21, "description": "Domain names can be involved in investigations of phishing, watering hole attacks, malware command and control, exfiltration, and many other malicious behaviors. Some of the key questions to answer about a domain are: Who controls the domain? Who registered the domain? What is the purpose of the domain? What services are hosted on the domain? What traffic would you expect to see to and from the domain? How popular is the domain? Does the domain host dynamic content such as cloud services? What sub-domains or parent domains are associated with the domain? Is the domain known to host malicious content? Where in the world is the domain hosted? How recently was the domain registered? What is the DNS history of the domain? Is the domain meant to look similar to another more legitimate domain? Does the domain name appear to have been randomly generated? The results of these queries can produce related IP addresses, file hashes, downloaded files, URLs, TLS certificates, and behaviors which are useful elsewhere in this investigation.", "suggestions": {"actions": ["domain reputation", "domain dns history", "geolocate domain", "lookup domain", "whois domain", "whois history", "query domain"], "playbooks": [{"scm": "community", "playbook": "simple_network_enrichment"}, {"scm": "community", "playbook": "symantec_ioc_data_enhancement"}]}, "create_time": "2020-06-30T13:21:35.708394Z", "modified_time": "2020-06-30T13:21:35.708542Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 78, "name": "Enrich IP addresses", "order": 3, "owner": null, "role": null, "phase": 21, "description": "Enrichment of IP addresses should be similar to domain names in many ways, but typically IP addresses will change more frequently. Frequent changes can be legitimate behavior caused by load balancers or content delivery networks, or it may be malicious behavior due to fast flux DNS changes, so additional context about the network traffic is needed. Also consider that traffic going straight to an IP address without doing a DNS query may be relevant to the investigation, and consider querying Tor or other anonymization systems to check if the IP address is a known exit node. Outputs of this task can inform URL enrichment, downloaded file analysis, domain name enrichment, TLS certificate enrichment, and more advanced behavioral analysis based on the services hosted at the IP address in question.", "suggestions": {"actions": ["ip reputation", "lookup ip", "reverse ip", "ip dns history", "whois ip", "query ip", "geolocate ip"], "playbooks": [{"scm": "community", "playbook": "ip_investigate_and_report"}, {"scm": "community", "playbook": "simple_network_enrichment"}]}, "create_time": "2020-06-30T13:21:35.708847Z", "modified_time": "2020-06-30T13:21:35.708992Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 79, "name": "Enrich TLS certificates", "order": 4, "owner": null, "role": null, "phase": 21, "description": "If an investigation involves a TLS certificate it may be useful to gather registrant and certificate authority information about that certificate, and to query for other usages of similar infrastructure. The usage of free and automated certificate authorities such as Let's Encrypt does not necessarily imply that a domain is malicious, but that is a common technique used to build malicious infrastructure so it should warrant further investigation. Consider comparing the registrant information and certificate authority chain with the expected values for the organization allegedly hosting the website in question.", "suggestions": {"actions": ["query certificate", "lookup certificate"]}, "create_time": "2020-06-30T13:21:35.709278Z", "modified_time": "2020-06-30T13:21:35.709424Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 80, "name": "Enrich MAC addresses", "order": 5, "owner": null, "role": null, "phase": 21, "description": "While MAC (media access control) addresses are less frequently involved in security investigations, when they are present they can sometimes be useful to cross-reference, identify, or profile a device. MAC addresses can be changed and spoofed, but it is usually less common than a change in IP address or hostname. In wifi investigations the MAC address can be used to identify both the access point and the clients that connect to it.", "suggestions": {"actions": ["lookup mac"], "playbooks": [{"scm": "community", "playbook": "rogue_wireless_access_point_remediate"}]}, "create_time": "2020-06-30T13:21:35.709677Z", "modified_time": "2020-06-30T13:21:35.709822Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Self-Replicating Malware", "is_default": false, "description": "This case template outlines a response to a potential infection by self-replicating malware (malware that propagates itself without human interaction). While there is much overlap between the response necessary for self-replicating malware and the response to any other malware, the ability to propagate from one system to the next automatically does add the potential for faster and more thorough infection of enterprise systems. Often the infection mechanism is a particular network service or shared resource, so an appropriate response tends to be a fast configuration change to contain the impact immediately.\n\nThis case template is adapted from a modified version of the CERT Societe Generale Incident Response Methodology called Worm Infection Response. The full methodology is available at https://github.com/certsocietegenerale/IRM/blob/master/EN/IRM-1-WormInfection.pdf and is covered under the Creative Commons Attribution 3.0 Imported license available at https://github.com/certsocietegenerale/IRM/blob/master/LICENSE.md, while the CERT Societe Generale homepage is https://cert.societegenerale.com/en/.", "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 6, "num_pages": 1, "data": [{"id": 22, "name": "Preparation", "order": 1, "create_time": "2020-06-30T13:21:35.713658Z", "modified_time": "2020-06-30T13:21:35.713794Z", "template": 6, "sla": null, "sla_type": "minutes", "tasks": [{"id": 81, "name": "Define team members", "order": 1, "owner": null, "role": null, "phase": 22, "description": "Determine which team members will play which role in the response and establish communications channels with all involved.", "suggestions": {"actions": ["list oncalls", "get users", "ask question", "send email"], "playbooks": [{"scm": "community", "playbook": "track_active_directory_admin_users"}]}, "create_time": "2020-06-30T13:21:35.714708Z", "modified_time": "2020-06-30T13:21:35.714877Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 82, "name": "Check analysis tools", "order": 2, "owner": null, "role": null, "phase": 22, "description": "Test connectivity, check patch level, and run example queries on all analysis tools.", "suggestions": {"actions": ["check status", "list patches", "run query"]}, "create_time": "2020-06-30T13:21:35.715155Z", "modified_time": "2020-06-30T13:21:35.715300Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 83, "name": "Acquire architecture map", "order": 3, "owner": null, "role": null, "phase": 22, "description": "Find or build an up-to-date map of the network.", "suggestions": {"actions": ["send email", "ask question", "list device groups"]}, "create_time": "2020-06-30T13:21:35.715541Z", "modified_time": "2020-06-30T13:21:35.715694Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 84, "name": "Acquire asset inventory", "order": 4, "owner": null, "role": null, "phase": 22, "description": "Find or build an up-to-date inventory of all devices.", "suggestions": {"actions": ["list devices"]}, "create_time": "2020-06-30T13:21:35.715932Z", "modified_time": "2020-06-30T13:21:35.716073Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 85, "name": "Continuous monitoring", "order": 5, "owner": null, "role": null, "phase": 22, "description": "Monitor threat trends and system activity.", "suggestions": {"actions": ["run query", "send email", "create ticket"]}, "create_time": "2020-06-30T13:21:35.716310Z", "modified_time": "2020-06-30T13:21:35.716451Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 23, "name": "Identification", "order": 2, "create_time": "2020-06-30T13:21:35.716686Z", "modified_time": "2020-06-30T13:21:35.716792Z", "template": 6, "sla": null, "sla_type": "minutes", "tasks": [{"id": 86, "name": "Detect the infection", "order": 1, "owner": null, "role": null, "phase": 23, "description": "Detect abnormalities and potential infections using endpoint and network intrusion detection systems, application logs, authentication logs, system load monitoring, notification from external sources, and other methods. Seek a repeatable detection that is as reliable as possible, as future steps will call for checking and re-checking to monitor progress.", "suggestions": {"actions": ["run query", "scan endpoint", "scan network"], "playbooks": [{"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.717693Z", "modified_time": "2020-06-30T13:21:35.717862Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 87, "name": "Identify the infection", "order": 2, "owner": null, "role": null, "phase": 23, "description": "Compare the known symptoms to all available threat intelligence and try to identify the threat as specifically as possible.", "suggestions": {"actions": ["list vulnerabilities", "file reputation", "ip reputation", "domain reputation"]}, "create_time": "2020-06-30T13:21:35.718129Z", "modified_time": "2020-06-30T13:21:35.718276Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 88, "name": "Assess the perimeter of the infection", "order": 3, "owner": null, "role": null, "phase": 23, "description": "Check systems in different parts of the organization to define the perimeter of the infection and assess the potential business impact.", "suggestions": {"actions": ["run query"]}, "create_time": "2020-06-30T13:21:35.718516Z", "modified_time": "2020-06-30T13:21:35.718670Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 24, "name": "Containment", "order": 3, "create_time": "2020-06-30T13:21:35.718905Z", "modified_time": "2020-06-30T13:21:35.719015Z", "template": 6, "sla": null, "sla_type": "minutes", "tasks": [{"id": 89, "name": "Disconnect infected areas from the Internet", "order": 1, "owner": null, "role": null, "phase": 24, "description": "Stop C2 and further propagation by disconnecting affected areas from the Internet.", "suggestions": {"actions": ["quarantine device", "vlan host", "block application"]}, "create_time": "2020-06-30T13:21:35.719917Z", "modified_time": "2020-06-30T13:21:35.720085Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 90, "name": "Isolate infected area from all networks", "order": 2, "owner": null, "role": null, "phase": 24, "description": "Enforce more strict network segmentation to prevent further internal spreading. Consider disconnecting mobile devices and laptops to minimize the propagation surface.", "suggestions": {}, "create_time": "2020-06-30T13:21:35.720340Z", "modified_time": "2020-06-30T13:21:35.720481Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 91, "name": "Monitor business-critical network connections that cannot be disconnected", "order": 3, "owner": null, "role": null, "phase": 24, "description": "For those applications that cannot be disconnected due to continuity needs, increase monitoring and analyze traffic for malicious activity.", "suggestions": {"actions": ["get pcap"]}, "create_time": "2020-06-30T13:21:35.720717Z", "modified_time": "2020-06-30T13:21:35.720857Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 92, "name": "Neutralize propagation vectors", "order": 4, "owner": null, "role": null, "phase": 24, "description": "Deploy patches, change configurations, sinkhole domains, re-image systems, stop services, or take other appropriate actions to prevent further propagation using all known vectors. Notify users of changes that will affect them and/or request their assistance for manual neutralization steps.", "suggestions": {"actions": ["deploy patch", "post data", "configure ssh", "send email", "block sender"], "playbooks": [{"scm": "community", "playbook": "wannacry_remediate"}, {"scm": "community", "playbook": "vmworld_wannacry_response"}, {"scm": "community", "playbook": "vmworld_c2_response"}]}, "create_time": "2020-06-30T13:21:35.721090Z", "modified_time": "2020-06-30T13:21:35.721229Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 93, "name": "Monitor progress", "order": 5, "owner": null, "role": null, "phase": 24, "description": "Re-check neutralized systems and repeat or improve processes to cover important systems as quickly as possible.", "suggestions": {"actions": ["run query"]}, "create_time": "2020-06-30T13:21:35.721479Z", "modified_time": "2020-06-30T13:21:35.721621Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 25, "name": "Remediation", "order": 4, "create_time": "2020-06-30T13:21:35.721856Z", "modified_time": "2020-06-30T13:21:35.721962Z", "template": 6, "sla": null, "sla_type": "minutes", "tasks": [{"id": 94, "name": "Identify", "order": 1, "owner": null, "role": null, "phase": 25, "description": "Consider vendor fixes, antivirus updates, external support options, and custom solutions. Use these to define a disinfection process and validate it with a reputable source if possible.", "suggestions": {"actions": ["send email", "get data"]}, "create_time": "2020-06-30T13:21:35.722855Z", "modified_time": "2020-06-30T13:21:35.723021Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 95, "name": "Test", "order": 2, "owner": null, "role": null, "phase": 25, "description": "Test the disinfection process on a system that is as close to production configuration as possible and verify that it works while not damaging any service.", "suggestions": {"actions": ["deploy patch", "run script", "run command"]}, "create_time": "2020-06-30T13:21:35.723275Z", "modified_time": "2020-06-30T13:21:35.723420Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 96, "name": "Deploy", "order": 3, "owner": null, "role": null, "phase": 25, "description": "Deploy the process and scale it up if possible.", "suggestions": {"actions": ["deploy patch", "run script", "run command"], "playbooks": [{"scm": "community", "playbook": "macos_root_password_mitigate"}, {"scm": "community", "playbook": "wannacry_remediate"}]}, "create_time": "2020-06-30T13:21:35.723719Z", "modified_time": "2020-06-30T13:21:35.723866Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 97, "name": "Confirm", "order": 4, "owner": null, "role": null, "phase": 25, "description": "Confirm that the malware did not block remediations and find a workaround if it did.", "suggestions": {"actions": ["run query"]}, "create_time": "2020-06-30T13:21:35.724111Z", "modified_time": "2020-06-30T13:21:35.724253Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 26, "name": "Recovery", "order": 5, "create_time": "2020-06-30T13:21:35.724478Z", "modified_time": "2020-06-30T13:21:35.724584Z", "template": 6, "sla": null, "sla_type": "minutes", "tasks": [{"id": 98, "name": "Verify Containment and Remediation", "order": 1, "owner": null, "role": null, "phase": 26, "description": "Review current progress towards remediation by re-checking systems.", "suggestions": {"actions": ["run query"], "playbooks": [{"scm": "community", "playbook": "reinfected_endpoint_check"}]}, "create_time": "2020-06-30T13:21:35.725471Z", "modified_time": "2020-06-30T13:21:35.725640Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 99, "name": "Reopen propagation network mechanism", "order": 2, "owner": null, "role": null, "phase": 26, "description": "Turn off network enforcement for a segment of the network and monitor for new attempts to reinfect.", "suggestions": {"actions": ["unquarantine device", "vlan host", "unblock sender"]}, "create_time": "2020-06-30T13:21:35.725911Z", "modified_time": "2020-06-30T13:21:35.726059Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 100, "name": "Reconnect isolated sub-areas to each other", "order": 3, "owner": null, "role": null, "phase": 26, "description": "Turn off inter-area network enforcement and monitor.", "suggestions": {}, "create_time": "2020-06-30T13:21:35.726294Z", "modified_time": "2020-06-30T13:21:35.726435Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 101, "name": "Reconnect mobile devices", "order": 4, "owner": null, "role": null, "phase": 26, "description": "Reconnect mobile devices and laptops to monitor for persistence and check coverage across all device categories.", "suggestions": {}, "create_time": "2020-06-30T13:21:35.726675Z", "modified_time": "2020-06-30T13:21:35.726818Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 102, "name": "Reconnect isolated areas to main enterprise network", "order": 5, "owner": null, "role": null, "phase": 26, "description": "Disable network enforcement between cleaned areas and the rest of the network while monitoring for reinfection.", "suggestions": {"playbooks": [{"scm": "community", "playbook": "reinfected_endpoint_check"}]}, "create_time": "2020-06-30T13:21:35.727052Z", "modified_time": "2020-06-30T13:21:35.727196Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 103, "name": "Reconnect to the Internet", "order": 6, "owner": null, "role": null, "phase": 26, "description": "Reconnect to the Internet and monitor.", "suggestions": {"actions": ["unblock domain"]}, "create_time": "2020-06-30T13:21:35.727428Z", "modified_time": "2020-06-30T13:21:35.727570Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 27, "name": "Aftermath", "order": 6, "create_time": "2020-06-30T13:21:35.727805Z", "modified_time": "2020-06-30T13:21:35.727911Z", "template": 6, "sla": null, "sla_type": "minutes", "tasks": [{"id": 104, "name": "Build crisis report", "order": 1, "owner": null, "role": null, "phase": 27, "description": "Notify affected parties with as much detail as is appropriate. Consider the initial cause of the infection, actions and timelines of important events, what went right, what went wrong, and the incident cost.", "suggestions": {"actions": ["get report", "get results", "send email"]}, "create_time": "2020-06-30T13:21:35.728790Z", "modified_time": "2020-06-30T13:21:35.728958Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 105, "name": "Improve processes", "order": 2, "owner": null, "role": null, "phase": 27, "description": "Capitalize on the experience by improving the processes that were used, creating new processes where needed, and automating that which is generalizable and repeatable.", "suggestions": {}, "create_time": "2020-06-30T13:21:35.729214Z", "modified_time": "2020-06-30T13:21:35.729359Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Suspicious Email", "is_default": false, "description": "There are a variety of ways in which email can be used by attackers to gain a foothold in an organization or advance an existing campaign. This workbook guides an analyst through the process of investigating and remediating several of these methods. Throughout the first three phases the main objective is to determine if the email is malicious and what impact it may have if the attack is successful. The fourth and fifth phases are focused on taking action to prevent further harm to the organization and conducting more investigation and analysis to learn more about the threat. Finally, the sixth phase describes communications to other parts of the organization which may be appropriate based on what was observed in the first five phases. This workbook uses the structure of the SOEL framework (https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1532986430.pdf) to organize the phases and tasks.", "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 6, "num_pages": 1, "data": [{"id": 28, "name": "Ingestion", "order": 1, "create_time": "2020-06-30T13:21:35.734136Z", "modified_time": "2020-06-30T13:21:35.734262Z", "template": 7, "sla": null, "sla_type": "minutes", "tasks": [{"id": 106, "name": "Create ticket", "order": 1, "owner": null, "role": null, "phase": 28, "description": "Create any necessary tickets or tracking documents describing the initial conditions of the suspicious email investigation. As additional information is collected or actions are taken in the following tasks and phases, update the ticket with links and relevant information to allow collaboration and tracking.", "suggestions": {"actions": ["create ticket", "send email", "send message"], "playbooks": [{"scm": "community", "playbook": "user_approved_ticket_creation"}]}, "create_time": "2020-06-30T13:21:35.735184Z", "modified_time": "2020-06-30T13:21:35.735354Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 107, "name": "Ingest email", "order": 2, "owner": null, "role": null, "phase": 28, "description": "Identify and ingest the suspicious email into Phantom. Actual steps vary depending on how the Phantom event is created and where the suspicious email resides. For example, if the suspicious email is sent to a dedicated email address for suspected phishing attempts, Phantom can poll that inbox directly with an App such as IMAP, EWS for Exchange, EWS for Office, or GSuite for GMail. This will create the event in Phantom and populate it with email headers, URL artifacts, domain artifacts, file attachments, to/from addresses, the text of the raw email, and other metadata. Alternatively, if the email is not already ingested directly into Phantom the \"get email\" action may be useful to retrieve it. For example, if a Splunk Notable Event based on the Email datamodel is used to detect a suspicious email, Phantom may be able to run \"get email\" to ingest the email based on the IMAP UID or other identifier. Another possible scenario is that the email of interest is included as an attachment on the email received by Phantom. In this case the \"extract email\" action may be able to ingest the email if it is in the .msg or .eml format.", "suggestions": {"actions": ["get email", "extract email"]}, "create_time": "2020-06-30T13:21:35.735630Z", "modified_time": "2020-06-30T13:21:35.735787Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 108, "name": "Extract actionable metadata and files", "order": 3, "owner": null, "role": null, "phase": 28, "description": "Depending on how the email was ingested, additional steps may be required to extract actionable metadata and files. For example, if the suspicious email is attached to the Phantom event as a file, the \"extract ioc\" action can be used to extract URLs, domain names, IP addresses, file hashes, and whole file attachments. In some cases specific Playbooks or ingestion scripts may need to be written to extract or reformat fields from the email. Be aware that malicious emails may obfuscate links and file attachments, so it may be necessary to view the email in a sandboxed email client to see it in the same context as a user would see it.", "suggestions": {"actions": ["extract ioc"]}, "create_time": "2020-06-30T13:21:35.736037Z", "modified_time": "2020-06-30T13:21:35.736179Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 29, "name": "External Investigation", "order": 2, "create_time": "2020-06-30T13:21:35.736410Z", "modified_time": "2020-06-30T13:21:35.736516Z", "template": 7, "sla": null, "sla_type": "minutes", "tasks": [{"id": 109, "name": "Investigate URLs", "order": 1, "owner": null, "role": null, "phase": 29, "description": "Perhaps the most common email attack vector is a clickable link that brings a user to a malicious website. The malicious website may collect credentials or other confidential information, it may attempt to exploit the user's browser, it may lead the user to download a malicious file, or it may simply gather preliminary fingerprint information about the user to inform further operations. Investigate all URLs contained in the suspicious email using a mix of automated and manual techniques. Query threat intelligence services and other sources of reputation information to see if the URLs are linked to known malicious activity. Check the categorization of the URLs and their popularity using services such as Censys or Alexa. Determine whether the URL is spoofing a brand using a similar spelling, a unicode substitution, or an out-of-order domain name. Also consider using a less passive technique that analyzes the current state of the URL, such as a sandboxed URL detonation, a website scanning tool such as urlscan.io or SSL Labs, a manual inspection from a sandboxed environment, or a website screenshot engine such as ScreenShot Machine. Consider that targeted attacks may only reveal the malicious behavior of a website if the user agent and/or the source address of the request matches the target environment. The output of this task might be more linked URLs, the domain names of the underlying servers responding to the request, other domain names used by the website, IP addresses, or downloadable files. All of the above should be passed on to further investigative tasks if needed.", "suggestions": {"actions": ["url reputation", "lookup url", "detonate url", "get screenshot", "run query"], "playbooks": [{"scm": "community", "playbook": "simple_network_enrichment"}, {"scm": "community", "playbook": "phishme_email_investigate_and_respond"}, {"scm": "community", "playbook": "symantec_ioc_data_enhancement"}, {"scm": "community", "playbook": "phishing_investigate_and_respond"}]}, "create_time": "2020-06-30T13:21:35.737395Z", "modified_time": "2020-06-30T13:21:35.737563Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 110, "name": "Investigate file attachments", "order": 2, "owner": null, "role": null, "phase": 29, "description": "Another common email attack vector is a malicious file attachment. Any file could be malicious, but most attacks involve executables, scripts, or documents. Investigate these files either using a whole copy of the file or the file hash. Query threat intelligence and reputation databases using the hash to see if the file has been seen before, to see if there is suspicious activity associated with the file, and to learn more about the file's behavior. Query for previous analyses or submit the file for examination in a dynamic or static tool to check for potentially malicious behaviors or properties. Actions used in this task may extract associated URLs, domain names, IP addresses, or secondary file hashes which should be explored further in other tasks.", "suggestions": {"actions": ["file reputation", "lookup hash", "analyze file", "extract ioc", "detonate file", "run query", "get report", "get file"], "playbooks": [{"scm": "community", "playbook": "mcafee_phishing_attachment_investigate"}]}, "create_time": "2020-06-30T13:21:35.737890Z", "modified_time": "2020-06-30T13:21:35.738038Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 111, "name": "Investigate email addresses and headers", "order": 3, "owner": null, "role": null, "phase": 29, "description": "The source email address and other headers contain a wide variety of information about the source environment of the email and the infrastructure used to send and receive it. Use a mix of automated and manual analysis to determine where the email came from and whether it uses headers in a suspicious way. Query threat intelligence and reputation databases using the \"From\", \"Sender\", and \"Reply-to\" addresses, as well as any other email addresses in the other header fields. Compare the display names of these fields to the actual values to see if misleading names are used. Check if the servers that received the email marked it with the appropriate authentication results for SPF, DKIM, and/or DMARC. If needed use Microsoft Message Header Analyzer, MxToolbox, or other tools to interpret the remaining headers. Outputs of this task such as domain names and IP addresses should be passed on to further tasks.", "suggestions": {"actions": ["email reputation", "reverse email", "lookup email"]}, "create_time": "2020-06-30T13:21:35.738328Z", "modified_time": "2020-06-30T13:21:35.738471Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 112, "name": "Investigate domains", "order": 4, "owner": null, "role": null, "phase": 29, "description": "At this point domain names from various sources should be collected in the event, including email sending and receiving servers, web servers from URLs in the email, domains associated to other indicators in threat intelligence databases, and domains contained in the file attachment or detected by the detonation of the file attachment. Check each of these against threat intelligence and reputation databases, passive DNS trackers, whois services, and other information services. Look for known malicious or unknown domains, focusing more on those associated to clickable URLs and file attachments. Evaluate what services are running on each suspicious domain using a scanning service such as Censys or Shodan. Check the TLS certificate (if any), the website categorization, the popularity, and any other available information. Compare this information to the expected outcome given the alleged context of the email. For unknown domains, consider the domain history, the hosting provider, and whether the domain name appears to have been dynamically generated. IP addresses currently and previously associated with the domain should be further processed elsewhere in this case.", "suggestions": {"actions": ["domain reputation", "domain dns history", "geolocate domain", "lookup domain", "query domain", "reverse domain", "reverse email domain", "whois domain"], "playbooks": [{"scm": "community", "playbook": "simple_network_enrichment"}, {"scm": "community", "playbook": "symantec_ioc_data_enhancement"}, {"scm": "community", "playbook": "phishing_investigate_and_respond"}]}, "create_time": "2020-06-30T13:21:35.738723Z", "modified_time": "2020-06-30T13:21:35.738866Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 113, "name": "Investigate IP addresses", "order": 5, "owner": null, "role": null, "phase": 29, "description": "IP addresses may be involved in this investigation for several reasons. Some email headers can contain IP addresses (such as X-Originating-IP), URLs can contain IP addresses instead of hostnames, file attachments can contain IP addresses or generate IP addresses and try to connect to them (like domain generation algorithms), and IP addresses can be added to the event through association or domain name resolution in other tasks within this investigation. IP addresses in URLs that are not organization internal IP addresses should be considered highly suspicious. Investigate all suspicious IP addresses by checking their reputation, geolocating them, gathering whois information, gathering DNS history information, and gathering information from other available services.", "suggestions": {"actions": ["ip reputation", "lookup ip", "whois ip", "ip dns history", "query ip", "get ip risk"], "playbooks": [{"scm": "community", "playbook": "simple_network_enrichment"}, {"scm": "community", "playbook": "threatquotient_investigate_and_respond"}]}, "create_time": "2020-06-30T13:21:35.739120Z", "modified_time": "2020-06-30T13:21:35.739262Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 114, "name": "Investigate email subject and body", "order": 6, "owner": null, "role": null, "phase": 29, "description": "The subject and body of an email can be malicious without containing a single URL or file attachment. The possibilities include emails that simply ask the receiver to reply with confidential information, emails that contain instructions to do insecure things, emails that manipulate automated systems which are parsing the email, and emails that prime the receiver for other interactions. Malicious emails often use current events such as tax season, a hurricane, or other publicly available information to establish a sense of trust or an illusion of urgency. Social engineering is perhaps the hardest technique to detect in an automated fashion, often requiring manual investigation. Consider the context of the message, the intended recipient, and the identity of the sender or alleged sender. It may be necessary to ask the recipient user if they think the email is legitimate.", "suggestions": {"actions": ["ask question"]}, "create_time": "2020-06-30T13:21:35.739511Z", "modified_time": "2020-06-30T13:21:35.739653Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 30, "name": "Internal Hunting", "order": 3, "create_time": "2020-06-30T13:21:35.739898Z", "modified_time": "2020-06-30T13:21:35.740007Z", "template": 7, "sla": null, "sla_type": "minutes", "tasks": [{"id": 115, "name": "Hunt email activity", "order": 1, "owner": null, "role": null, "phase": 30, "description": "Find other similar emails sent into the organization based on the sender address, sender domain, subject, embedded URLs, file attachments, or other similar attributes shared across multiple emails. If possible determine which emails were opened, forwarded, deleted, marked as spam, or reported as potential phishing. Consider which types of users are targeted and why. Also check whether internal users replied to the emails and what information was contained in the replies.", "suggestions": {"actions": ["run query", "run command", "hunt email", "get email", "get user"]}, "create_time": "2020-06-30T13:21:35.740902Z", "modified_time": "2020-06-30T13:21:35.741070Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 116, "name": "Hunt network activity", "order": 2, "owner": null, "role": null, "phase": 30, "description": "Based on previously collected information try to determine whether or not URLs in the email were clicked, phishing websites were visited, or other suspicious network connections were made from the computers of users who opened the email. This could be done using many types of network monitoring, including netflow, full packet capture, DNS logging, and/or endpoint monitoring.", "suggestions": {"actions": ["hunt domain", "hunt ip", "hunt url", "run query"], "playbooks": [{"scm": "community", "playbook": "zscaler_hunt_and_block_url"}, {"scm": "community", "playbook": "ip_investigate_and_report"}]}, "create_time": "2020-06-30T13:21:35.741330Z", "modified_time": "2020-06-30T13:21:35.741474Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 117, "name": "Hunt file executions", "order": 3, "owner": null, "role": null, "phase": 30, "description": "If a file attachment was included with the email, try to determine which users downloaded the attachment and which users executed it or opened it in some other way. Use the file hash of the attachment to search across endpoint monitoring or network monitoring solutions for the transmission and/or execution of the file. If executions are detected, try to determine the behavior of the created process. If a potentially malicious document or other file type was opened, try to determine which application opened it and whether the file exploited or abused the opening application.", "suggestions": {"actions": ["hunt file", "hunt hash", "get file", "run query", "get process file", "get process detail", "get system info"], "playbooks": [{"scm": "community", "playbook": "zscaler_malicious_file_response"}]}, "create_time": "2020-06-30T13:21:35.741726Z", "modified_time": "2020-06-30T13:21:35.741868Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 118, "name": "Hunt user activity", "order": 4, "owner": null, "role": null, "phase": 30, "description": "If a phishing attempt or other user account compromise attempt is suspected, investigate how the credentials or account access are being used. Enumerate resources available to the account and search the access logs for those resources, looking for anomalous usage patterns.", "suggestions": {"actions": ["run query", "get user", "get user importance", "get user attributes", "hunt user", "list user groups", "ask question"], "playbooks": [{"scm": "community", "playbook": "track_active_directory_admin_users"}]}, "create_time": "2020-06-30T13:21:35.742142Z", "modified_time": "2020-06-30T13:21:35.742284Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 31, "name": "Enforcement and increased monitoring", "order": 4, "create_time": "2020-06-30T13:21:35.742529Z", "modified_time": "2020-06-30T13:21:35.742635Z", "template": 7, "sla": null, "sla_type": "minutes", "tasks": [{"id": 119, "name": "Block or monitor email activity", "order": 1, "owner": null, "role": null, "phase": 31, "description": "If specific malicious emails have been identified, delete them from any mailboxes in which they still pose a threat. Similarly, if a sender address or an entire sender domain is found to be malicious, block inbound email from that source. Set filtering rules to block inbound email or increase monitoring of email based on other detected characteristics of an email campaign or malicious technique.", "suggestions": {"actions": ["delete email", "block sender", "blacklist sender", "blacklist email", "move email"]}, "create_time": "2020-06-30T13:21:35.743537Z", "modified_time": "2020-06-30T13:21:35.743716Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 120, "name": "Block or monitor network activity", "order": 2, "owner": null, "role": null, "phase": 31, "description": "Based on gathered indicators and metadata, block or increase monitoring of malicious network connections associated with the suspicious email. Prevent other receivers of similar phishing emails from accessing the clickable URL by blocking that URL itself, the underlying domain name, and/or the underlying IP addresses. If malware or unwanted software was detected, block outbound connections known to be associated with that malware based on threat intelligence or dynamic analysis. If the threat is severe enough, consider isolating entire portions of the network.", "suggestions": {"actions": ["block url", "blacklist url", "disallow url", "unwhitelist url", "block domain", "blacklist domain", "block ip", "blacklist ip", "block network"], "playbooks": [{"scm": "community", "playbook": "zscaler_hunt_and_block_url"}, {"scm": "community", "playbook": "user_prompt_and_block_domain"}]}, "create_time": "2020-06-30T13:21:35.743978Z", "modified_time": "2020-06-30T13:21:35.744122Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 121, "name": "Block or monitor file executions", "order": 3, "owner": null, "role": null, "phase": 31, "description": "Based on gathered indicators and metadata, block or increase monitoring of endpoint activity caused by the suspicious email. This could mean blocking the hash of the file attachment, blocking the hash of a file downloaded from a URL in an email, blocking a malicious hash associated with the email by threat intelligence, or blocking secondary executions such as dropped stages of malware identified from dynamic analysis.", "suggestions": {"actions": ["block hash", "block file path", "remove file", "delete file"], "playbooks": [{"scm": "community", "playbook": "zscaler_malicious_file_response"}, {"scm": "community", "playbook": "wannacry_remediate"}, {"scm": "community", "playbook": "protectwise_investigate_and_respond"}]}, "create_time": "2020-06-30T13:21:35.744373Z", "modified_time": "2020-06-30T13:21:35.744515Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 122, "name": "Contain endpoints", "order": 4, "owner": null, "role": null, "phase": 31, "description": "If an endpoint compromise is suspected, it may be necessary to quarantine or otherwise contain that endpoint until further investigation and remediation can be done. Consider the criticality of the system and the likelihood of a compromise. In other cases simply increasing the monitoring or scanning for more information may be prudent.", "suggestions": {"actions": ["quarantine device", "tag device", "scan endpoint", "snapshot instance"], "playbooks": [{"scm": "community", "playbook": "rootkit_remediate"}]}, "create_time": "2020-06-30T13:21:35.744769Z", "modified_time": "2020-06-30T13:21:35.744910Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 123, "name": "Contain user accounts", "order": 5, "owner": null, "role": null, "phase": 31, "description": "If a user account compromise is suspected, it may be necessary to reset the credentials, reduce the account privileges, or disable the account until further investigation is completed.", "suggestions": {"actions": ["disable user", "deactivate user", "logoff user", "ask question", "reset password", "remove access", "remove member"]}, "create_time": "2020-06-30T13:21:35.745150Z", "modified_time": "2020-06-30T13:21:35.745289Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 32, "name": "Longer-running analysis jobs", "order": 5, "create_time": "2020-06-30T13:21:35.745515Z", "modified_time": "2020-06-30T13:21:35.745619Z", "template": 7, "sla": null, "sla_type": "minutes", "tasks": [{"id": 124, "name": "Analyze network activity", "order": 1, "owner": null, "role": null, "phase": 32, "description": "Conduct any resource-intensive analysis of network activity left over from the External Investigation and Internal Hunting phases. This could mean full packet capture collection and analysis, sandbox detonation of URLs, long-running queries of network history and anomalous behavior, or other similar analysis tasks.", "suggestions": {"actions": ["detonate url", "scan url", "ip dns history", "run query"]}, "create_time": "2020-06-30T13:21:35.746504Z", "modified_time": "2020-06-30T13:21:35.746683Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 125, "name": "Analyze endpoint activity", "order": 2, "owner": null, "role": null, "phase": 32, "description": "Conduct deeper analysis on remaining malware and endpoint investigation tasks not finished in the External Investigation and Internal Hunting phases. This could mean sandbox detonation of files, forensic analysis of associated devices or memory dumps, reverse engineering of suspected malware, long-running queries of endpoint activity history and anomalous behavior, or other similar analysis tasks.", "suggestions": {"actions": ["detonate file", "get process detail", "get command history", "get browser history", "get snapshot info"]}, "create_time": "2020-06-30T13:21:35.746942Z", "modified_time": "2020-06-30T13:21:35.747088Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 33, "name": "Notification", "order": 6, "create_time": "2020-06-30T13:21:35.747320Z", "modified_time": "2020-06-30T13:21:35.747425Z", "template": 7, "sla": null, "sla_type": "minutes", "tasks": [{"id": 126, "name": "Update tickets", "order": 1, "owner": null, "role": null, "phase": 33, "description": "Ensure that all the necessary outputs and status updates from the previous phases and tasks are documented in the appropriate system of record. Summarize the current state of the investigation and any remaining tasks.", "suggestions": {"actions": ["update ticket"]}, "create_time": "2020-06-30T13:21:35.748297Z", "modified_time": "2020-06-30T13:21:35.748464Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 127, "name": "Notify system owners", "order": 2, "owner": null, "role": null, "phase": 33, "description": "For any systems that have been changed or need to be changed, notify the necessary system owners so the appropriate change management procedures can be followed.", "suggestions": {"actions": ["create ticket", "send email", "send message"]}, "create_time": "2020-06-30T13:21:35.748721Z", "modified_time": "2020-06-30T13:21:35.748866Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 128, "name": "Notify regulatory compliance team", "order": 3, "owner": null, "role": null, "phase": 33, "description": "If appropriate, notify the regulatory compliance team to support them as they report this incident to the correct regulatory or accrediting organizations.", "suggestions": {"actions": ["create ticket", "send email", "send message"]}, "create_time": "2020-06-30T13:21:35.749101Z", "modified_time": "2020-06-30T13:21:35.749242Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 129, "name": "Assign additional tasks", "order": 4, "owner": null, "role": null, "phase": 33, "description": "Create tickets to track any follow-on tasks that came out of this case. Example tasks may include conducting deeper endpoint investigation, re-provisioning systems, re-enabling accounts, or tuning filtering systems to block future emails.", "suggestions": {"actions": ["create ticket", "create alert", "send email", "send message"]}, "create_time": "2020-06-30T13:21:35.749474Z", "modified_time": "2020-06-30T13:21:35.749615Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 130, "name": "Educate users", "order": 5, "owner": null, "role": null, "phase": 33, "description": "If appropriate, inform the broader user base about the types of suspicious emails being sent to the organization to try to prevent them from clicking on malicious links or opening malicious file attachments in the future.", "suggestions": {"actions": ["send email", "send message"]}, "create_time": "2020-06-30T13:21:35.749869Z", "modified_time": "2020-06-30T13:21:35.750012Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 131, "name": "Share threat intelligence", "order": 6, "owner": null, "role": null, "phase": 33, "description": "If appropriate, communicate relevant findings to trusted third parties and/or the public threat intelligence community. Ensure that outbound messages do not contain confidential information. Consider sharing or confirming the usage of indicators and techniques to peer organizations, security vendors, public databases, or industry-specific threat intelligence sharing communities.", "suggestions": {"actions": ["post data", "send message", "send email"]}, "create_time": "2020-06-30T13:21:35.750245Z", "modified_time": "2020-06-30T13:21:35.750385Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Vulnerability Disclosure", "is_default": false, "description": null, "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 4, "num_pages": 1, "data": [{"id": 34, "name": "Understand the vulnerability", "order": 1, "create_time": "2020-06-30T13:21:35.754267Z", "modified_time": "2020-06-30T13:21:35.754390Z", "template": 8, "sla": null, "sla_type": "minutes", "tasks": [{"id": 132, "name": "Research types of systems that are affected", "order": 1, "owner": null, "role": null, "phase": 34, "description": "Research the known hardware or software systems and versions that are affected. If possible use a vulnerability database or software composition analysis solution to walk the dependency chain and evaluate the scope of the vulnerability.", "suggestions": {"actions": ["get vulnerability", "list vulnerabilities"]}, "create_time": "2020-06-30T13:21:35.755286Z", "modified_time": "2020-06-30T13:21:35.755453Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 133, "name": "Research how the vulnerability works", "order": 2, "owner": null, "role": null, "phase": 34, "description": "Research the mechanism by which the system is vulnerable and the conditions in which the system is vulnerable. Often there are certain configurations, software packages, system states, operating modes, and other characteristics that make a vulnerability exploitable and affect the impact if exploited. Assess the difficulty to exploit and the reliability of the exploit.", "suggestions": {"actions": ["get data", "run query", "get vulnerability"]}, "create_time": "2020-06-30T13:21:35.755719Z", "modified_time": "2020-06-30T13:21:35.755864Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 35, "name": "Understand impact to the organization", "order": 2, "create_time": "2020-06-30T13:21:35.756122Z", "modified_time": "2020-06-30T13:21:35.756229Z", "template": 8, "sla": null, "sla_type": "minutes", "tasks": [{"id": 134, "name": "Find potentially affected systems", "order": 1, "owner": null, "role": null, "phase": 35, "description": "Check the internal environment and dependencies of the organization for the software or hardware that is vulnerable.", "suggestions": {"actions": ["run query", "get system attributes", "get system info", "run command", "execute program", "run script", "get scan data", "detonate url", "scan endpoint", "scan network", "scan url"], "playbooks": [{"scm": "community", "playbook": "macos_ard_enumeration"}, {"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.757115Z", "modified_time": "2020-06-30T13:21:35.757282Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 135, "name": "Determine exploitability", "order": 2, "owner": null, "role": null, "phase": 35, "description": "Check for exploitable conditions. If appropriate attempt to implement the vulnerability or use a safe proof of concept to verify exploitability.", "suggestions": {"actions": ["run query", "run command", "run script", "scan endpoint"]}, "create_time": "2020-06-30T13:21:35.757552Z", "modified_time": "2020-06-30T13:21:35.757710Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 136, "name": "Investigate possible exploitation", "order": 3, "owner": null, "role": null, "phase": 35, "description": "Investigate whether or not vulnerable systems were in fact exploited. Use the particular behavior of the exploit and likely post-exploitation techniques to narrow down the search for exploited systems.", "suggestions": {"actions": ["run query", "get log", "extract ioc"], "playbooks": [{"scm": "community", "playbook": "ssh_endpoint_investigate"}]}, "create_time": "2020-06-30T13:21:35.757953Z", "modified_time": "2020-06-30T13:21:35.758097Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 36, "name": "Decide how to respond", "order": 3, "create_time": "2020-06-30T13:21:35.758332Z", "modified_time": "2020-06-30T13:21:35.758437Z", "template": 8, "sla": null, "sla_type": "minutes", "tasks": [{"id": 137, "name": "Evaluate patches, workarounds, and service outages", "order": 1, "owner": null, "role": null, "phase": 36, "description": "Consider how mitigations, remediations, and forced system shutdowns will impact the situation.", "suggestions": {"playbooks": [{"scm": "community", "playbook": "alert_escalation_for_attacked_executives"}, {"scm": "community", "playbook": "alert_deescalation_for_test_machines"}]}, "create_time": "2020-06-30T13:21:35.759318Z", "modified_time": "2020-06-30T13:21:35.759486Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}, {"id": 37, "name": "Execute the response", "order": 4, "create_time": "2020-06-30T13:21:35.759750Z", "modified_time": "2020-06-30T13:21:35.759858Z", "template": 8, "sla": null, "sla_type": "minutes", "tasks": [{"id": 138, "name": "Remediate", "order": 1, "owner": null, "role": null, "phase": 37, "description": "Apply patches, upgrades, configuration changes, or state changes that will remediate the vulnerability.", "suggestions": {"actions": ["deploy patch", "run command", "run script", "execute program"], "playbooks": [{"scm": "community", "playbook": "wannacry_remediate"}]}, "create_time": "2020-06-30T13:21:35.760733Z", "modified_time": "2020-06-30T13:21:35.760901Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 139, "name": "Mitigate", "order": 2, "owner": null, "role": null, "phase": 37, "description": "Apply workarounds, temporary fixes, additional hardening, new security tools, new detections, and other mitigations to reduce risk.", "suggestions": {"actions": ["add firewall rule", "block hash", "blacklist domain", "reboot system"]}, "create_time": "2020-06-30T13:21:35.761163Z", "modified_time": "2020-06-30T13:21:35.761310Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 140, "name": "Document accepted risks", "order": 3, "owner": null, "role": null, "phase": 37, "description": "Document remaining risk and notify stakeholders.", "suggestions": {"actions": ["send email", "send message", "create ticket"]}, "create_time": "2020-06-30T13:21:35.761546Z", "modified_time": "2020-06-30T13:21:35.761702Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Risk Investigation", "is_default": false, "description": "Use dynamic playbooks and prompts to investigate risk notable events from Splunk Enterprise Security. Built to be used with the Risk Notable Playbook Pack. See the following for documentation of the entire pack: https://docs.splunk.com/Documentation/ESSOC/latest/user/Useplaybookpack", "is_note_required": false, "file_location": "/opt/phantom/vault/tmp", "count": 1, "num_pages": 1, "data": [{"id": 38, "name": "Investigate", "order": 1, "create_time": "2021-11-20T06:03:31.435877Z", "modified_time": "2021-11-20T06:03:31.436128Z", "template": 9, "sla": null, "sla_type": "minutes", "tasks": [{"id": 141, "name": "Preprocess", "order": 1, "owner": null, "role": null, "phase": 38, "description": "1. \"risk_notable_preprocess\" prepares the notable for investigation, links back to the notable in Enterprise Security, and updates the container metadata.\n\n2. \"risk_notable_import_data\" handles finding associated artifacts and importing them into the playbook\n\n3. Start triage of the event by selecting \"start_investigation\" which will assign the owner, move the status to Open, and finish the first task.", "suggestions": {"playbooks": [{"scm": "community", "playbook": "risk_notable_preprocess"}, {"scm": "community", "playbook": "risk_notable_import_data"}, {"scm": "community", "playbook": "start_investigation"}]}, "create_time": "2021-11-20T06:03:31.438232Z", "modified_time": "2021-11-20T06:03:31.438516Z", "is_note_required": false, "sla": null, "sla_type": "minutes"}, {"id": 142, "name": "Investigate", "order": 2, "owner": null, "role": null, "phase": 38, "description": "1. Review evidence collected by playbooks.\n- \"risk_notable_enrich\" handles investigating specific indicators\n- Perform additional analysis and information gathering where necessary\n\n2. \"risk_notable_merge_events\" will show any related events and prompt the user to merge those events into a case either individually or all at once.\n\n3. When finished reviewing evidence, Complete Task", "suggestions": {"playbooks": [{"scm": "community", "playbook": "risk_notable_enrich"}, {"scm": "community", "playbook": "risk_notable_merge_events"}]}, "create_time": "2021-11-20T06:03:31.439485Z", "modified_time": "2021-11-20T06:03:31.439680Z", "is_note_required": false, "sla": null, "sla_type": "minutes"}, {"id": 143, "name": "Render Verdict", "order": 3, "owner": null, "role": null, "phase": 38, "description": "1. Finish Initial Triage by selecting a response and providing justification.\n- \"risk_notable_verdict\" will load your available playbooks that have the tag \"response_option\" and present them as options in a prompt. It will also load the Risk Response workbook containing tasks to block indicators and protect entities.", "suggestions": {"playbooks": [{"scm": "community", "playbook": "risk_notable_verdict"}]}, "create_time": "2021-11-20T06:03:31.439976Z", "modified_time": "2021-11-20T06:03:31.440161Z", "is_note_required": false, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Risk Response", "is_default": false, "description": "Use dynamic playbooks and prompts to semi-automatically review and block indicators, protect assets, and protect users. Built to be used with the Risk Notable Playbook Pack. See the following for documentation of the entire pack: https://docs.splunk.com/Documentation/ESSOC/latest/user/Useplaybookpack", "is_note_required": false, "file_location": "/opt/phantom/vault/tmp", "count": 1, "num_pages": 1, "data": [{"id": 39, "name": "Mitigate", "order": 1, "create_time": "2021-11-20T06:03:31.445486Z", "modified_time": "2021-11-20T06:03:31.445647Z", "template": 10, "sla": null, "sla_type": "minutes", "tasks": [{"id": 144, "name": "Review and Block Indicators", "order": 1, "owner": null, "role": null, "phase": 39, "description": "1. \"risk_notable_review_indicators\" creates a prompt you can use to review suspicious indicators from the investigate playbook and mark them to be blocked.\n\n2. \"risk_notable_block_indicators\" will then find indicators that are marked for block and pass them to playbooks designed to mitigate those indicators.", "suggestions": {"playbooks": [{"scm": "community", "playbook": "risk_notable_review_indicators"}, {"scm": "community", "playbook": "risk_notable_block_indicators"}]}, "create_time": "2021-11-20T06:03:31.446649Z", "modified_time": "2021-11-20T06:03:31.446861Z", "is_note_required": false, "sla": null, "sla_type": "minutes"}, {"id": 145, "name": "Protect Assets and Users", "order": 2, "owner": null, "role": null, "phase": 39, "description": "1. \"risk_notable_protect_assets_and_users\" will locate asset and identity information for the current investigation. If there are protection playbooks available (such as playbooks that disable user accounts or quarantine devices), you will be prompted to determine which assets and entities to protect.", "suggestions": {"playbooks": [{"scm": "community", "playbook": "risk_notable_protect_assets_and_users"}]}, "create_time": "2021-11-20T06:03:31.447152Z", "modified_time": "2021-11-20T06:03:31.447342Z", "is_note_required": false, "sla": null, "sla_type": "minutes"}]}]}, {"name": "Frothly Investigation & Response Template", "is_default": false, "description": "Frothly Investigation & Response Template", "is_note_required": true, "file_location": "/opt/phantom/vault/tmp", "count": 1, "num_pages": 1, "data": [{"id": 40, "name": "Indicator Enrichment & Investigation", "order": 1, "create_time": "2022-03-07T05:17:39.389305Z", "modified_time": "2022-03-07T05:17:39.389568Z", "template": 11, "sla": 240, "sla_type": "minutes", "tasks": [{"id": 146, "name": "Check Domain Reputation", "order": 1, "owner": null, "role": null, "phase": 40, "description": "Check domain reputation using available threat intelligence services such as VirusTotal", "suggestions": {"actions": ["domain reputation"]}, "create_time": "2022-03-07T05:17:39.394176Z", "modified_time": "2022-03-07T05:17:39.394463Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 147, "name": "Lookup Domain", "order": 2, "owner": null, "role": null, "phase": 40, "description": "Lookup domain using domain lookup services such as Whois", "suggestions": {}, "create_time": "2022-03-07T05:17:39.396309Z", "modified_time": "2022-03-07T05:17:39.396507Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 148, "name": "Check File Reputation", "order": 3, "owner": null, "role": null, "phase": 40, "description": "Check file reputation using available threat intelligence services such as VirusTotal", "suggestions": {}, "create_time": "2022-03-07T05:17:39.396788Z", "modified_time": "2022-03-07T05:17:39.396969Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}, {"id": 149, "name": "Geolocate IP Address", "order": 4, "owner": null, "role": null, "phase": 40, "description": "Geolocate IP address using IP geolocation services such as Maxmind", "suggestions": {}, "create_time": "2022-03-07T05:17:39.397232Z", "modified_time": "2022-03-07T05:17:39.397412Z", "is_note_required": true, "sla": null, "sla_type": "minutes"}]}]}]}